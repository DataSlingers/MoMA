<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to the <code>MoMA</code> Package • MoMA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to the &lt;code&gt;MoMA&lt;/code&gt; Package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MoMA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/moma-quick-start.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/moma-functional-data-analysis.html">Funtional Data Analysis</a>
    </li>
    <li>
      <a href="../articles/moma-PCA.html">Principal Component Anlaysis</a>
    </li>
    <li>
      <a href="../articles/moma-LDA.html">Linear Discriminant Analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/DataSlingers/MoMA">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to the <code>MoMA</code> Package</h1>
                        <h4 class="author">Michael Weylandt, Luofeng Liao</h4>
            
            <h4 class="date">2019-08-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/DataSlingers/MoMA/blob/master/vignettes/moma-quick-start.Rmd"><code>vignettes/moma-quick-start.Rmd</code></a></small>
      <div class="hidden name"><code>moma-quick-start.Rmd</code></div>

    </div>

    
    
<p>The unified SFPCA (Sparse and Functional Principal Component Analysis) method enjoys many advantages over existing approaches to regularized PC, because it</p>
<ul>
<li><p>allows for arbitrary degrees and forms of regularization;</p></li>
<li><p>unifies many existing methods;</p></li>
<li><p>admits a tractable, efficient, and theoretically well-grounded algorithm.</p></li>
</ul>
<p>The problem is formulated as follows.</p>
<p><span class="math display">\[\max_{u,\,,v}{u}^{T} {X} {v}-\lambda_{{u}} P_{{u}}({u})-\lambda_{{v}} P_{{v}}({v})\]</span> <span class="math display">\[\text{s.t.  } \| u \| _ {S_u} \leq 1, \, \| v \| _ {S_v} \leq 1.\]</span> Typically, we take <span class="math inline">\({S}_{{u}}={I}+\alpha_{{u}} {\Omega}_{{u}}\)</span> where <span class="math inline">\(\Omega_u\)</span> is the second- or fourth-difference matrix, so that the <span class="math inline">\(\|u \|_{S_u}\)</span> penalty term encourages smoothness in the estimated singular vectors. <span class="math inline">\(P_u\)</span> and <span class="math inline">\(P_v\)</span> are sparsity inducing penalties that satisfy the following conditions:</p>
<ul>
<li><p><span class="math inline">\(P \geq 0\)</span>, <span class="math inline">\(P\)</span> defined on <span class="math inline">\([0,+\infty)\)</span>;</p></li>
<li><p><span class="math inline">\(P(cx) = c P (x), \forall \, c &gt; 0\)</span>.</p></li>
</ul>
<div id="a-wide-range-of-modeling-options" class="section level2">
<h2 class="hasAnchor">
<a href="#a-wide-range-of-modeling-options" class="anchor"></a>A Wide Range of Modeling Options</h2>
<p>Currently, the package supports arbitrary combination of the following.</p>
<div id="various-sparsity-inducing-penalties" class="section level4">
<h4 class="hasAnchor">
<a href="#various-sparsity-inducing-penalties" class="anchor"></a>Various sparsity-inducing penalties</h4>
<p>So far, we have incorporated the following penalties in MoMA. The code under each penalty is only an example specification of the penalty. They should be carefully tailored based on your particular data set.</p>
<ul>
<li>LASSO (least absolute shrinkage and selection operator), see <code>moma_lasso</code>;</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># `non_negative`: impose non-negativity constraint or not</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="../reference/lasso.html">moma_lasso</a></span>(<span class="dt">non_negative =</span> TURE)</a></code></pre></div>
<ul>
<li>SCAD <code>moma_lasso</code>(smoothly clipped absolute deviation), see <code>moma_scad</code>;</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># `gamma` is the non-convexity parameter</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw"><a href="../reference/scad.html">moma_scad</a></span>(<span class="dt">gamma =</span> <span class="dv">3</span>, <span class="dt">non_negative =</span> TURE)</a></code></pre></div>
<ul>
<li>MCP (minimax concave penalty), see <code>moma_mcp</code>;</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># `gamma` is the non-convexity parameter</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw"><a href="../reference/mcp.html">moma_mcp</a></span>(<span class="dt">gamma =</span> <span class="dv">3</span>, <span class="dt">non_negative =</span> TURE)</a></code></pre></div>
<ul>
<li>SLOPE (sorted <span class="math inline">\(\ell\)</span>-one penalized estimation), see <code>moma_slope</code>;</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># `gamma` is the non-convexity parameter</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="../reference/slope.html">moma_slope</a></span>(<span class="dt">gamma =</span> <span class="dv">3</span>, <span class="dt">non_negative =</span> TURE)</a></code></pre></div>
<ul>
<li>Group LASSO, see <code>moma_grplasso</code>;</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># `g` is a factor indicating the grouping</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw"><a href="../reference/group_lasso.html">moma_grplasso</a></span>(<span class="dt">g =</span> g, <span class="dt">non_negative =</span> TURE)</a></code></pre></div>
<ul>
<li>Fused LASSO, see <code>moma_fusedlasso</code>;</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># `algo` is indicates which algorithm to solve the proximal operator</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># "dp": dynamic programming, "path": path-based algorithm</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="../reference/fused_lasso.html">moma_fusedlasso</a></span>(<span class="dt">algo =</span> <span class="st">"dp"</span>)</a></code></pre></div>
<ul>
<li>L1 trend filtering, see <code>moma_l1tf</code>;</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># `l1tf_k = 2` imposes piece-wise linear</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw"><a href="../reference/l1_trend_filtering.html">moma_l1tf</a></span>(<span class="dt">l1tf_k =</span> <span class="dv">2</span>)</a></code></pre></div>
<ul>
<li>Sparse fused LASSO, see <code>moma_spfusedlasso</code>;</li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># `lambda2` is penalty level for the adjacent difference</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="../reference/sparse_fused_lasso.html">moma_spfusedlasso</a></span>(<span class="dt">lambda2 =</span> <span class="dv">1</span>)</a></code></pre></div>
<ul>
<li>Cluster penalty, see <code>moma_cluster</code>.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># `w` is a symmectric matrix, whose entry, w[i][j], is the weight connecting</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co"># the i-th and the j-th element</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw"><a href="../reference/cluster.html">moma_cluster</a></span>(<span class="dt">w =</span> w)</a></code></pre></div>
</div>
<div id="parameter-selection-schemes" class="section level4">
<h4 class="hasAnchor">
<a href="#parameter-selection-schemes" class="anchor"></a>Parameter selection schemes</h4>
<ul>
<li><p>Exhaustive search</p></li>
<li><p>Nested BIC. See <code>select_scheme</code> for details.</p></li>
</ul>
</div>
<div id="multivariate-methods" class="section level4">
<h4 class="hasAnchor">
<a href="#multivariate-methods" class="anchor"></a>Multivariate methods</h4>
<ul>
<li><p>PCA (Principal Component Analysis). See <code>moma_sfpca</code>.</p></li>
<li><p>CCA (Canonical Component Analysis). See <code>moma_sfcca</code>.</p></li>
<li><p>LDA (Linear Discriminant Anlsysis). See <code>moma_sflda</code>.</p></li>
<li><p>PLS (Partial Least Square) (TODO)</p></li>
<li><p>Correspondence Analysis (TODO)</p></li>
</ul>
</div>
<div id="deflation-schemes" class="section level4">
<h4 class="hasAnchor">
<a href="#deflation-schemes" class="anchor"></a>Deflation schemes</h4>
<ul>
<li><p>Hotelling’s deflation (PCA)</p></li>
<li><p>Projection deflation (PCA, CCA, LDA)</p></li>
<li><p>Schur’s complement (PCA)</p></li>
</ul>
</div>
</div>
<div id="excellent-user-experience" class="section level2">
<h2 class="hasAnchor">
<a href="#excellent-user-experience" class="anchor"></a>Excellent User Experience</h2>
<ul>
<li>Easy-to-use functions. Let <span class="math inline">\(\Delta\)</span> be a second-difference matrix of appropriate size, such that <span class="math inline">\(u^T\Delta u = \sum_i (u_{i} - u_{i-1} )^2\)</span>. For a matrix <span class="math inline">\(X\)</span>, one line of code can solve the following penalized singular value decomposition problem:</li>
</ul>
<p><span class="math display">\[\max_{u,\, v} \, {u}^{T} {X} {v} - 4  \sum_i | v_i - v_{i-1}|\]</span> <span class="math display">\[ \text{s.t.  } u^T(I + 3 \Delta) u \leq 1,\, v^Tv \leq 1.\]</span></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># `p` is the length of `u`</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw"><a href="../reference/moma_sfpca.html">moma_sfpca</a></span>(X,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">    <span class="dt">center =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">    <span class="dt">v_sparse =</span> <span class="kw"><a href="../reference/fused_lasso.html">moma_fusedlasso</a></span>(<span class="dt">lambda =</span> <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb10-5" data-line-number="5">    <span class="dt">u_smooth =</span> <span class="kw"><a href="../reference/moma_smoothness.html">moma_smoothness</a></span>(<span class="kw"><a href="../reference/second_diff_mat.html">second_diff_mat</a></span>(p), <span class="dt">alpha =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">)</a></code></pre></div>
<ul>
<li><p>R6 methods to support access of results.</p></li>
<li><p>Shiny supports interation with MoMA.</p></li>
<li><p>Fast. <code>MoMA</code> uses the <code>Rcpp</code> and <code>RcppArmadillo</code> libraries for speed <span class="citation">(Eddelbuettel and François 2011; Eddelbuettel and Sanderson 2014; Sanderson and Curtin 2016)</span>.</p></li>
</ul>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Eddelbuettel:2011">
<p>Eddelbuettel, Dirk, and Romain François. 2011. “<code>Rcpp</code>: Seamless <code>R</code> and <code>C++</code> Integration.” <em>Journal of Statistical Software</em> 40 (8): 1–18. <a href="https://doi.org/10.18637/jss.v040.i08" class="uri">https://doi.org/10.18637/jss.v040.i08</a>.</p>
</div>
<div id="ref-Eddelbuettel:2014">
<p>Eddelbuettel, Dirk, and Conrad Sanderson. 2014. “<code>RcppArmadillo</code>: Accelerating <code>R</code> with High-Performance <code>C++</code> Linear Algebra.” <em>Computational Statistics and Data Analysis</em> 71: 1054–63. <a href="https://doi.org/10.1016/j.csda.2013.02.005" class="uri">https://doi.org/10.1016/j.csda.2013.02.005</a>.</p>
</div>
<div id="ref-Sanderson:2016">
<p>Sanderson, Conrad, and Ryan Curtin. 2016. “<code>Armadillo</code>: A Template-Based <code>C++</code> Library for Linear Algebra.” <em>Journal of Open Source Software</em> 1 (2): 26. <a href="https://doi.org/10.21105/joss.00026" class="uri">https://doi.org/10.21105/joss.00026</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#a-wide-range-of-modeling-options">A Wide Range of Modeling Options</a></li>
      <li><a href="#excellent-user-experience">Excellent User Experience</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Michael Weylandt, Genevera Allen, Luofeng Liao.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
